<div class="ui container mb-48">
  <div class="sb-pageSection my-24">
    <div class="d-flex flex-ai-center flex-jc-space-between">
      <div class="sb-pageSection-header mb-0">
        <h4 class="sb-pageSection-title">
          <span *ngIf="!isContributor || activeMyProgramsMenu">{{ resourceService.frmelmnts.lbl.myPrograms }} </span>
          <span *ngIf="activeAllProgramsMenu">{{ resourceService.frmelmnts.lbl.explorePrograms }} </span>
          <span class="sb-pagSection-count sb-label sb-label-x sb-label-warning ml-8 px-8"
            *ngIf="programs && programs.length">{{count}}</span></h4>
      </div>
      <!-- <button routerLink="sourcing/create-program" *ngIf="this.router.url.includes('/sourcing')" class="sb-btn sb-btn-normal sb-btn-primary"><i class="plus outline icon"></i> Add New Program</button> -->
    </div>
    <div class="sb-pageSection-content mt-12">
      <ng-container *ngIf="programs !== undefined else loading">
        <ng-container *ngIf="programs.length else noResult">
          <div class="">
             <table class="sb-table sb-table-striped sb-table-hover sb-table-sortable">
            <thead class="sb-table-header sb-table-thead-gray">
              <tr>
                <th class="w-20 sb-sort-icon">{{ resourceService.frmelmnts.lbl.program }}</th>
                <th class="w-20">{{ resourceService.frmelmnts.lbl.gradesMediumsSubjects }}</th>
                <th *ngIf="!isContributor">{{ resourceService.frmelmnts.lbl.nominations }}</th>
                <th *ngIf="!isContributor">{{ 'Program Status & Dates' }}</th>
                <th *ngIf="activeMyProgramsMenu" class="sb-sort-icon">{{ resourceService.frmelmnts.lbl.contributionDate }}</th>
                <th *ngIf="activeAllProgramsMenu">{{ 'Program Dates' }}</th>
                <th *ngIf="activeMyProgramsMenu"><span class="ui dropdown sb-table-dropdown d-inline-flex" suiDropdown>
                  <div class="text">{{ resourceService.frmelmnts.lbl.nominationStatus }}</div>
                  <i class="filter icon"></i>
                  <div class="menu" suiDropdownMenu>
                      <div class="item">All</div>
                      <div class="item">Pending</div>
                      <div class="item selected">Approved</div>
                      <div class="item">Rejected</div>
                  </div>
              </span></th>
                <th class="w-10 text-center">{{ resourceService.frmelmnts.lbl.actions }}</th>
              </tr>
            </thead>
            <tbody class="sb-table-body">
              <tr *ngFor="let program of programs">
                <td> 
                  <div class="sb__ellipsis sb__ellipsis--three sb-color-primary font-weight-bold">
                    {{program?.name}}
                  </div>
                  <div class="sb__ellipsis sb__ellipsis--three">{{ getProgramTextbooksCount(program) }}</div>
                  <div *ngIf="activeMyProgramsMenu" class="sb-label-value mt-4">{{ getProgramInfo(program, 'board') }}</div>
                </td>
                <td>
                  <div class="sb__ellipsis sb__ellipsis--breakAll " suiPopup  popupDelay="1000" popupHeader="{{ resourceService.frmelmnts.lbl.grades }}" popupText="{{ getProgramInfo(program, 'gradeLevel') }}">{{ getProgramInfo(program, 'gradeLevel') }}</div>
                  <hr class="divider">
                  <div class="sb__ellipsis sb__ellipsis--breakAll " suiPopup  popupDelay="1000" popupHeader="{{ resourceService.frmelmnts.lbl.mediums }}" popupText="{{ getProgramInfo(program, 'medium') }}">{{ getProgramInfo(program, 'medium') }}</div>
                  <hr class="divider">
                  <div class="sb__ellipsis sb__ellipsis--breakAll " suiPopup  popupDelay="1000" popupHeader="{{ resourceService.frmelmnts.lbl.subjects }}" popupText="{{ getProgramInfo(program, 'subject') }}">{{ getProgramInfo(program, 'subject') }}</div>
                </td>
                <td *ngIf="!isContributor">
                  <div>{{ program?.nominations?.pending }} {{ resourceService.frmelmnts.lbl.pending }}</div>
                  <hr class="divider">
                  <div>{{ program?.nominations?.approved }} {{ resourceService.frmelmnts.lbl.approved }}</div>
                  <hr class="divider">
                  <div>{{ program?.nominations?.rejected }} {{ resourceService.frmelmnts.lbl.rejected }}</div>
                </td>
                <td *ngIf="activeMyProgramsMenu" >
                  <div>{{ program?.content_submission_enddate | date:'LLLL d, yyyy'  }}<br>
                    <em>{{ program?.content_submission_enddate | daysToGo }}</em>
                  </div>
                </td>
                <td *ngIf="!isContributor || activeAllProgramsMenu">
                  <div class="program-timeline">
                    <div class="program-timeline-item">
                      <div class="status completed">
                        <div class="status__label">Nomination Submission</div>
                        <div class="status__date">
                          {{ program?.nomination_enddate | date:'d LLL yy'  }}
                          <em>20 days to go</em></div>
                      </div>
                    </div>
                         <div class="program-timeline-item">
                      <div class="status active">
                        <div class="status__label">Shortlisting Nominations</div>
                        <div class="status__date">
                          {{ program?.shortlisting_enddate | date:'d LLL yy'  }}
                          <em></em></div>
                      </div>
                    </div>
                    <div class="program-timeline-item">
                      <div class="status">
                        <div class="status__label">Contributions</div>
                        <div class="status__date">
                          {{ program?.content_submission_enddate | date:'d LLL yy'  }} <em></em></div>
                      </div>
                    </div>
                  </div>
                </td>
                <td *ngIf="activeMyProgramsMenu">
                  <span class="sb-label sb-label-table sb-label-primary-100">{{ getProgramNominationStatus(program) }}</span>
                </td>
                <td class="text-center">
                  <button type="button" class="sb-btn sb-btn-outline-primary sb-btn-normal" *ngIf="!isContributor" (click)="viewDetailsBtnClicked(program)">{{ resourceService.frmelmnts.lbl.viewDetails }}</button>           
                  <div class="ui dropdown sb-dotted-dropdown" *ngIf="isContributor" suiDropdown autoClose="itemClick">
                        <div class="p-8 w-auto"><span class="sb-dotmenu"></span></div>
                        <div class="menu" suiDropdownMenu>
                            <div class="item" (click)="viewDetailsBtnClicked(program)">{{ resourceService.frmelmnts.lbl.viewDetails }}</div>
                            <div class="item" *ngIf="activeMyProgramsMenu">{{ resourceService.frmelmnts.lbl.assignRole }}</div>
                        </div>
                    </div>
                    <!-- <button class="sb-btn sb-btn-xs sb-btn-outline-primary" (click)="viewDetailsBtnClicked(program)">{{ resourceService.frmelmnts.lbl.viewDetails }}</button> -->
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </ng-container>
        <ng-template #noResult>
          <app-no-result [data]="{messageText: resourceService.messages.stmsg.m0006}"></app-no-result>
        </ng-template>
      </ng-container>
      <ng-template #loading>
        <app-loader></app-loader>
      </ng-template>
    </div>
  </div>
</div>